# Some Dissembly Required

## x) Read/watch/listen and summarize

* Hammond 2022: [Ghidra for Reverse Engineering (PicoCTF 2022 #42 'bbbloat')](https://www.youtube.com/watch?v=oTD_ki86c9I). In this video, John Hammond demonstrates how to solve a "reverse engineering" challenge from PicoCTF 2022. Here is a brief summary of the steps he takes:
    * He starts by running the program, which asks for a "favorite number." Since he doesn't know the answer, the program exits.
    * He tries several *basic tools* first like `ltrace`, `strace`, `gdb`, etc. to seek some *low hanging fruits*, but they don't provide the answer.
    * He then opens the file in Ghidra&mdash;a popular reverse engineering tool. By searching for the text "favorite number" in *defined strings*, he traces the exact place in the code where the check happens.
    * Inside the code, he discovers the hexadecimal value `0x86187` (i.e. `549255` in decimal) which is used to reveal the *flag* of the challenge&mdash;`picoCTF{...}`.

* Optional: € Eagle and Nancy 2020: [The Ghidra Book: 2. Reversing And Disassembly Tools](https://learning.oreilly.com/library/view/the-ghidra-book/9781098125684/xhtml/ch02.xhtml#ch02lev29). Look, I’d love to dive into *The Ghidra Book* and give you the summary of Chapter 2, but there’s a slight technical difficulty&mdash;my wallet is currently screaming *"Not enough minerals!"* I tried typing *"show me the money"* with my keyboard about fifty times, but apparently, it does not work. No 10,000 gas, no 10,000 minerals, and definitely no "free" access to O'Reilly's library for me either. Just `F10`, `E`, `Q` then.

## a) Install Ghidra

It's just easy peasy! All I have to do is just to follow the installation guides, here and there.

* Install [SDKMAN!](https://sdkman.io/)
```bash
$ curl -s "https://get.sdkman.io" | bash
``` 
* Install [JDK 21 64-bit](https://adoptium.net/temurin/releases)
```bash
$ sdk install java 21.0.9-ms
```
* Download the [release file](https://github.com/NationalSecurityAgency/ghidra/releases)
```bash
$ wget https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_12.0.2_build/ghidra_12.0.2_PUBLIC_20260129.zip
```
* Extract the Ghidra release file.
```bash
$ unzip ghidra_12.0.2_PUBLIC_20260129.zip
```

Because I'm using an ARM-based system, I have to perform some addition steps&mdash;but they are still *pieces of cake!*

* Install [Gradle](https://gradle.org/)
```bash
$ sdk install gradle
```
* Build Ghidra's native components
```bash
$ cd ghidra_12.0.2_PUBLIC/support/gradle/
$ gradle buildNatives
```

Let's reverse engineer!

## b) packd

Honestly, I struggled from the start. I couldn't apply anything I learned from the Ghidra workshop. No `strcmp`, no `__libc_` prefix, etc. Nothing! Even though I found a string `What's the password?` in the Defined strings window, but double clicking on it didn't lead me anywhere. Why? Is it that difficult? I remember Tero said to us that this is just a beginner level. Really?

Then, I read the tips again, and&mdash;wait! I realized this is the zip file used in the h3 homework. Was't it `packd` that was *packed*? Oh man, how could I miss that part? I scrambled back to my laptop, whipped open the terminal, and&mdash;with the extreme caution of a man who just realized he’s been trying to decompile a packed file for an hour&mdash;I retried every single step.

* Unpack the binary
```bash
$ upx -d packd
```
* Use Ghidra to open the unpacked version
![Unpacked packd analyzed with Ghidra](screenshots/b/packd.png)

*"Battlecruiser operational!"* `piilos-AnAnAs`
